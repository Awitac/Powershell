# Creatated by Awitac 
# Changes                                                                                                       ES 2023-04-09
#
#############################################################################################################################
#
#
#############################################################################################################################
#
# Define the FCM API endpoint
$FCMEndpoint = "https://fcm.googleapis.com/fcm/send"

# Define the FCM server key
$FCMServerKey = "AAAAiaS9WUg:APA91bGj-A5rR6W2ZijeZiW81mbUVAMpaBtchptOXGqpuIjv9dX0sRYYqR20a2TCHI7ODIUYvnS21Du3sixfKk_9VPP7QIaEK0llhi2FAnnYTjlRX6jgvvw_hMZRgGkHoYo3E4gJW1o3"

# Define the FCM sender ID
$FCMSenderID = "591174392136"

# Define the FCM device token
#$FCMDeviceToken = "fMZcBmwkQzmqiQKHCXSCsJ:APA91bHP4IQ62vEILOBq2eTHVGmC6Rs8jwXihFGOa_TWKr4ta0O_iRsbsRXKYiuzuINPpaJzBc8RxLvAC6NjXYXHipfYSOfk-2ufah0f86J8uEG8ct0FxmvKcbnIWCitWEnur9QPmtu8"
$FCMDeviceToken = "cJDhfUc2T6aV4s5HTOjO6V:APA91bGfkKLZmZG1vRLbBns76SVJ5dbBh5DwMIuBm2xYiu6_yeHLobszfc4xr1QZOjc5PiA7n1lJ8t10Mr13c34hhkF-1hGYScTyZ04Zy3g10IhLCKepKye2W-ototpDU05woCWmWLh3"

# Define the notification payload
$NotificationPayload = @{
    notification = @{
        title = "Title FCM test from PowerShell, BAAAATISAAAK!!!"
        body = "Body FCM test from PowerShell, BAAAATISAAAK KYKLE!!"
    }
    to = $FCMDeviceToken
}

# Convert the payload to JSON
$NotificationPayloadJSON = $NotificationPayload | ConvertTo-Json

# Define the FCM request headers
$FCMHeaders = @{
    "Authorization" = "Bearer $FCMServerKey"
    "Content-Type" = "application/json"
    "project_id" = $FCMSenderID
}

# Send the FCM request
$FCMResponse = Invoke-RestMethod -Uri $FCMEndpoint -Method Post -Headers $FCMHeaders -Body $NotificationPayloadJSON

# Output the FCM response
Write-Output $FCMResponse
